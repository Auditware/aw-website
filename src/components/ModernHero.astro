---
import { Image } from 'astro:assets';

export interface SplotchPosition {
  top?: string;
  bottom?: string;
  left?: string;
  right?: string;
  width: string;
  height: string;
}

export interface ColorScheme {
  // Gradient text colors (5 stops)
  gradientText: {
    stop1: string;
    stop2: string;
    stop3: string;
    stop4: string;
    stop5: string;
  };
  // Background gradient splotches
  splotch1: { color: string; opacity: number; position?: SplotchPosition };
  splotch2: { color: string; opacity: number; position?: SplotchPosition };
  splotch3: { color: string; opacity: number; position?: SplotchPosition };
  // Button colors
  button: {
    primary: { start: string; end: string };
    primaryHover: { start: string; end: string };
    border: { color: string; opacity: number };
  };
  // Text colors
  text: {
    title: string; // RGB color for main title text
    description: string; // RGB color for description text
  };
  // Accent colors
  accent: {
    imageBorder: { color: string; opacity: number };
    imageGlow: { start: string; startOpacity: number; end: string; endOpacity: number };
    dotPattern: { color: string; opacity: number };
    gridPattern: { color: string; opacity: number };
    badge: { color: string; opacity: number };
  };
  // Hero background
  heroBackground?: {
    start: { color: string; opacity: number };
    end: { color: string; opacity: number };
  };
}

export interface Props {
  title: string;
  subtitle?: string;
  description: string;
  primaryCta: {
    text: string;
    href: string;
  };
  secondaryCta?: {
    text: string;
    href: string;
  };
  imageUrl?: string;
  imageAlt?: string;
  badges?: Array<{
    text: string;
    href?: string;
    icon?: string;
  }>;
  colorScheme?: ColorScheme;
}

// Default purple color scheme
const defaultColorScheme: ColorScheme = {
  gradientText: {
    stop1: '255, 255, 255', // Pure white
    stop2: '255, 255, 255', // Pure white
    stop3: '250, 245, 255', // Very light purple
    stop4: '243, 232, 255', // Light purple
    stop5: '233, 213, 255', // Subtle purple
  },
  splotch1: { color: '139, 92, 246', opacity: 0.2 },
  splotch2: { color: '124, 58, 237', opacity: 0.15 },
  splotch3: { color: '79, 99, 255', opacity: 0.12 },
  button: {
    primary: { start: '139, 92, 246', end: '124, 58, 237' },
    primaryHover: { start: '167, 139, 250', end: '139, 92, 246' },
    border: { color: '139, 92, 246', opacity: 0.4 },
  },
  text: {
    title: '255, 255, 255', // White for title
    description: '160, 160, 160', // Default gray for description
  },
  accent: {
    imageBorder: { color: '139, 92, 246', opacity: 0.3 },
    imageGlow: { start: '124, 58, 237', startOpacity: 0.8, end: '139, 92, 246', endOpacity: 0.6 },
    dotPattern: { color: '255, 255, 255', opacity: 0.4 },
    gridPattern: { color: '255, 255, 255', opacity: 0.04 },
    badge: { color: '139, 92, 246', opacity: 0.2 },
  },
};

const { 
  title, 
  subtitle, 
  description, 
  primaryCta, 
  secondaryCta, 
  imageUrl, 
  imageAlt = '', 
  badges = [],
  colorScheme = defaultColorScheme
} = Astro.props;

const cs = colorScheme;
---

<section class="hero" style={`
  --gradient-text-1: ${cs.gradientText.stop1};
  --gradient-text-2: ${cs.gradientText.stop2};
  --gradient-text-3: ${cs.gradientText.stop3};
  --gradient-text-4: ${cs.gradientText.stop4};
  --gradient-text-5: ${cs.gradientText.stop5};
  --splotch-1-color: ${cs.splotch1.color};
  --splotch-1-opacity: ${cs.splotch1.opacity};
  --splotch-2-color: ${cs.splotch2.color};
  --splotch-2-opacity: ${cs.splotch2.opacity};
  --splotch-3-color: ${cs.splotch3.color};
  --splotch-3-opacity: ${cs.splotch3.opacity};
  --button-primary-start: ${cs.button.primary.start};
  --button-primary-end: ${cs.button.primary.end};
  --button-primary-hover-start: ${cs.button.primaryHover.start};
  --button-primary-hover-end: ${cs.button.primaryHover.end};
  --button-border-color: ${cs.button.border.color};
  --button-border-opacity: ${cs.button.border.opacity};
  --image-border-color: ${cs.accent.imageBorder.color};
  --image-border-opacity: ${cs.accent.imageBorder.opacity};
  --image-glow-start: ${cs.accent.imageGlow.start};
  --image-glow-start-opacity: ${cs.accent.imageGlow.startOpacity};
  --image-glow-end: ${cs.accent.imageGlow.end};
  --image-glow-end-opacity: ${cs.accent.imageGlow.endOpacity};
  --dot-pattern-color: ${cs.accent.dotPattern.color};
  --dot-pattern-opacity: ${cs.accent.dotPattern.opacity};
  --grid-pattern-color: ${cs.accent.gridPattern.color};
  --grid-pattern-opacity: ${cs.accent.gridPattern.opacity};
  --badge-color: ${cs.accent.badge.color};
  --badge-opacity: ${cs.accent.badge.opacity};
  --title-color: ${cs.text.title};
  --description-color: ${cs.text.description};
  ${cs.heroBackground ? `
  --hero-bg-start-color: ${cs.heroBackground.start.color};
  --hero-bg-start-opacity: ${cs.heroBackground.start.opacity};
  --hero-bg-end-color: ${cs.heroBackground.end.color};
  --hero-bg-end-opacity: ${cs.heroBackground.end.opacity};
  ` : ''}
  ${cs.splotch1.position ? `
  --splotch-1-top: ${cs.splotch1.position.top || 'auto'};
  --splotch-1-bottom: ${cs.splotch1.position.bottom || 'auto'};
  --splotch-1-left: ${cs.splotch1.position.left || 'auto'};
  --splotch-1-right: ${cs.splotch1.position.right || 'auto'};
  --splotch-1-width: ${cs.splotch1.position.width};
  --splotch-1-height: ${cs.splotch1.position.height};
  ` : ''}
  ${cs.splotch2.position ? `
  --splotch-2-top: ${cs.splotch2.position.top || 'auto'};
  --splotch-2-bottom: ${cs.splotch2.position.bottom || 'auto'};
  --splotch-2-left: ${cs.splotch2.position.left || 'auto'};
  --splotch-2-right: ${cs.splotch2.position.right || 'auto'};
  --splotch-2-width: ${cs.splotch2.position.width};
  --splotch-2-height: ${cs.splotch2.position.height};
  ` : ''}
  ${cs.splotch3.position ? `
  --splotch-3-top: ${cs.splotch3.position.top || 'auto'};
  --splotch-3-bottom: ${cs.splotch3.position.bottom || 'auto'};
  --splotch-3-left: ${cs.splotch3.position.left || 'auto'};
  --splotch-3-right: ${cs.splotch3.position.right || 'auto'};
  --splotch-3-width: ${cs.splotch3.position.width};
  --splotch-3-height: ${cs.splotch3.position.height};
  ` : ''}
`}>
  <div class="container">
    <div class="hero-content">
      <div class="hero-grid">
        <div class="hero-text">
          {subtitle && (
            <div class="hero-subtitle-badge">
              <span class="badge">{subtitle}</span>
            </div>
          )}
          
          <h1 class="hero-title">
            <span set:html={title} />
          </h1>
          
          <p class="hero-description body-large">
            {description}
          </p>
          
          {badges.length > 0 && (
            <div class="hero-badges">
              {badges.map((badge) => (
                <a href={badge.href} class="framework-badge-icon-link" target="_blank" rel="noopener noreferrer" title={badge.text}>
                  {badge.icon && (
                    badge.icon.startsWith('http') ? (
                      <img src={badge.icon} alt={badge.text} class="framework-badge-icon" loading="lazy" />
                    ) : (
                      <Image src={badge.icon} alt={badge.text} class="framework-badge-icon" width={48} height={48} loading="lazy" />
                    )
                  )}
                </a>
              ))}
            </div>
          )}
          
          <div class="hero-cta">
            <a href={primaryCta.href} class="btn btn-primary btn-lg">
              {primaryCta.text}
              <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </a>
            {secondaryCta && (
              <a href={secondaryCta.href} class="btn btn-secondary btn-lg">
                {secondaryCta.text}
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M3 8H13M13 8L9 4M13 8L9 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </a>
            )}
          </div>
        </div>
        
        {imageUrl && (
          <div class="hero-visual">
            <div class="hero-image-container">
              {imageUrl.startsWith('http') ? (
                <img 
                  src={imageUrl} 
                  alt={imageAlt}
                  class="hero-image"
                  loading="eager"
                />
              ) : (
                <Image 
                  src={imageUrl} 
                  alt={imageAlt}
                  class="hero-image"
                  width={650}
                  height={450}
                  loading="eager"
                  format="webp"
                />
              )}
              <div class="hero-image-glow"></div>
            </div>
          </div>
        )}
      </div>
    </div>
  </div>
  
  <!-- Background Elements -->
  <div class="hero-bg-elements">
    <div class="hero-gradient-1"></div>
    <div class="hero-gradient-2"></div>
    <div class="hero-gradient-3"></div>
    <div class="hero-grid-pattern"></div>
    <div class="hero-dotted-pattern"></div>
  </div>
</section>

<style>
  .hero {
    position: relative;
    display: flex;
    align-items: center;
    background: transparent;
    overflow: hidden;
    padding: var(--spacing-8) 0;
    border-bottom: 1px solid var(--color-border-primary);
  }

  /* Dynamic Hero Background */
  .hero[style*="--hero-bg-start-color"] {
    background: linear-gradient(
      180deg, 
      rgba(var(--hero-bg-start-color), var(--hero-bg-start-opacity)) 0%, 
      transparent 50%, 
      rgba(var(--hero-bg-end-color), var(--hero-bg-end-opacity)) 100%
    );
  }
  
  .hero-content {
    position: relative;
    z-index: 1;
    width: 100%;
  }
  
  .hero-grid {
    display: grid;
    grid-template-columns: 1.1fr 0.9fr;
    gap: var(--spacing-20);
    align-items: center;
    min-height: auto;
  }
  
  .hero-text {
    max-width: 660px;
  }
  
  .hero-subtitle-badge {
    margin-bottom: var(--spacing-8);
    animation: fade-in-up 0.6s var(--ease-out);
  }
  
  .hero-title {
    font-size: clamp(2.5rem, 5vw, 5rem);
    font-weight: var(--font-weight-black);
    line-height: 1.15;
    margin-top: var(--spacing-6);
    margin-bottom: var(--spacing-8);
    letter-spacing: -0.025em;
    animation: fade-in-up 0.6s 0.1s var(--ease-out) backwards;
    text-wrap: balance;
    font-feature-settings: 'liga' 1, 'kern' 1;
    background: linear-gradient(
      135deg,
      rgb(var(--gradient-text-1)) 0%,
      rgb(var(--gradient-text-2)) 25%,
      rgb(var(--gradient-text-3)) 50%,
      rgb(var(--gradient-text-4)) 75%,
      rgb(var(--gradient-text-5)) 100%
    );
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    font-style: normal;
  }
  
  .hero-description {
    margin-bottom: var(--spacing-10);
    max-width: 560px;
    font-size: var(--font-size-xl);
    line-height: var(--line-height-relaxed);
    color: rgb(var(--description-color));
    animation: fade-in-up 0.6s 0.2s var(--ease-out) backwards;
  }
  
  .hero-badges {
    display: flex;
    flex-direction: row;
    flex-wrap: wrap;
    gap: var(--spacing-5);
    margin-bottom: var(--spacing-12);
    animation: fade-in-up 0.6s 0.3s var(--ease-out) backwards;
  }
  
  .hero-cta {
    display: flex;
    gap: var(--spacing-4);
    flex-wrap: wrap;
    animation: fade-in-up 0.6s 0.4s var(--ease-out) backwards;
  }
  
  .hero-visual {
    display: flex;
    justify-content: center;
    align-items: center;
    animation: fade-in 0.8s 0.5s var(--ease-out) backwards;
  }
  
  .hero-image-container {
    position: relative;
    max-width: 650px;
    width: 100%;
  }
  
  .hero-image {
    width: 100%;
    height: auto;
    border-radius: var(--radius-3xl);
    box-shadow: var(--shadow-elevation-high);
    border: 1px solid rgba(var(--image-border-color), var(--image-border-opacity));
    transition: transform var(--transition-slower), box-shadow var(--transition-slower);
  }
  
  .hero-image-container:hover .hero-image {
    transform: translateY(-8px);
    box-shadow: 0 0 0 1px rgba(var(--image-border-color), calc(var(--image-border-opacity) + 0.1)), 
                0 12px 48px rgba(var(--splotch-1-color), 0.4);
  }
  
  .hero-image-glow {
    position: absolute;
    top: 30px;
    left: 30px;
    right: 30px;
    bottom: 30px;
    background: linear-gradient(
      135deg, 
      rgba(var(--image-glow-start), var(--image-glow-start-opacity)) 0%, 
      rgba(var(--image-glow-end), var(--image-glow-end-opacity)) 100%
    );
    border-radius: var(--radius-3xl);
    opacity: 0.3;
    filter: blur(50px);
    z-index: -1;
    transition: opacity var(--transition-slower);
  }
  
  .hero-image-container:hover .hero-image-glow {
    opacity: 0.5;
  }
  
  /* Background Elements */
  .hero-bg-elements {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 0;
  }
  
  .hero-gradient-1 {
    position: absolute;
    top: var(--splotch-1-top, -50%);
    bottom: var(--splotch-1-bottom, auto);
    left: var(--splotch-1-left, auto);
    right: var(--splotch-1-right, -20%);
    width: var(--splotch-1-width, 80%);
    height: var(--splotch-1-height, 120%);
    background: radial-gradient(ellipse, rgba(var(--splotch-1-color), var(--splotch-1-opacity)) 0%, transparent 50%);
  }
  
  .hero-gradient-2 {
    position: absolute;
    top: var(--splotch-2-top, auto);
    bottom: var(--splotch-2-bottom, -30%);
    left: var(--splotch-2-left, -20%);
    right: var(--splotch-2-right, auto);
    width: var(--splotch-2-width, 60%);
    height: var(--splotch-2-height, 80%);
    background: radial-gradient(ellipse, rgba(var(--splotch-2-color), var(--splotch-2-opacity)) 0%, transparent 50%);
  }

  .hero-gradient-3 {
    position: absolute;
    top: var(--splotch-3-top, 50%);
    bottom: var(--splotch-3-bottom, auto);
    left: var(--splotch-3-left, auto);
    right: var(--splotch-3-right, 10%);
    width: var(--splotch-3-width, 40%);
    height: var(--splotch-3-height, 60%);
    background: radial-gradient(circle, rgba(var(--splotch-3-color), var(--splotch-3-opacity)) 0%, transparent 60%);
  }


  /* Dynamic Button Styling */
  .hero .btn-primary {
    background: linear-gradient(135deg, rgb(var(--button-primary-start)) 0%, rgb(var(--button-primary-end)) 100%);
    border-color: rgba(var(--button-border-color), var(--button-border-opacity));
    box-shadow: 0 0 0 1px rgba(var(--button-border-color), calc(var(--button-border-opacity) * 0.5)), 
                0 4px 20px rgba(var(--button-primary-start), 0.3);
  }

  .hero .btn-primary:hover {
    background: linear-gradient(135deg, rgb(var(--button-primary-hover-start)) 0%, rgb(var(--button-primary-hover-end)) 100%);
    border-color: rgba(var(--button-border-color), calc(var(--button-border-opacity) + 0.1));
    box-shadow: 0 0 0 1px rgba(var(--button-border-color), calc(var(--button-border-opacity) + 0.1)), 
                0 8px 32px rgba(var(--button-primary-start), 0.4);
    transform: translateY(-2px);
  }

  .hero .btn-secondary {
    background: rgba(var(--button-primary-start), 0.1);
    border-color: rgba(var(--button-border-color), var(--button-border-opacity));
  }

  .hero .btn-secondary:hover {
    background: rgba(var(--button-primary-start), 0.15);
    border-color: rgba(var(--button-border-color), calc(var(--button-border-opacity) + 0.1));
    box-shadow: 0 4px 16px rgba(var(--button-primary-start), 0.2);
  }

  /* Dynamic Badge Styling */
  .hero .badge {
    background: rgba(var(--badge-color), var(--badge-opacity));
    border-color: rgba(var(--button-border-color), var(--button-border-opacity));
  }

  .hero .badge:hover {
    background: rgba(var(--badge-color), calc(var(--badge-opacity) + 0.1));
    border-color: rgba(var(--button-border-color), calc(var(--button-border-opacity) + 0.1));
  }
  
  .hero-grid-pattern {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: 
      radial-gradient(circle at 1px 1px, rgba(var(--grid-pattern-color), var(--grid-pattern-opacity)) 1px, transparent 0);
    background-size: 48px 48px;
    opacity: 0.4;
  }

  /* Dotted Background Pattern */
  .hero-dotted-pattern {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.15;
    background-image: radial-gradient(circle at 25px 25px, rgba(var(--dot-pattern-color), var(--dot-pattern-opacity)) 2px, transparent 0);
    background-size: 50px 50px;
    pointer-events: none;
    z-index: -1;
  }
  
  
  /* Responsive Design */
  @media (max-width: 1199px) {
    .hero-grid {
      grid-template-columns: 1fr;
      gap: var(--spacing-16);
      text-align: center;
    }
    
    .hero-text {
      max-width: none;
      margin: 0 auto;
    }
    
    .hero-description {
      margin-left: auto;
      margin-right: auto;
    }
    
    .hero-badges {
      justify-content: center;
      align-items: center;
    }
    
    .hero-cta {
      justify-content: center;
    }
  }
  
  @media (max-width: 767px) {
    .hero {
      padding: var(--spacing-6) 0;
    }
    
    .hero-grid {
      gap: var(--spacing-12);
      min-height: auto;
    }
    
    .hero-description {
      font-size: var(--font-size-lg);
      margin-bottom: var(--spacing-8);
    }
    
    .hero-cta {
      flex-direction: column;
      align-items: center;
    }
    
    .hero-cta .btn {
      width: 100%;
      max-width: 320px;
    }
  }
  
  @media (max-width: 479px) {
    .hero {
      padding: var(--spacing-4) 0;
    }
    
    .hero-badges {
      gap: var(--spacing-3);
    }
    
    .hero-description {
      font-size: var(--font-size-base);
    }
    
    .framework-badge-icon-link .framework-badge-icon {
      height: 48px;
      width: auto;
    }
    
    .framework-badge-icon-link:nth-child(2) .framework-badge-icon {
      height: 38px;
    }
  }
</style>
